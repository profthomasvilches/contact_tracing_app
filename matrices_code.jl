



function vector_probs()
    #this must be written as the reverse vector of incidence
    if p.prov == :ontario
        v = [0.00242697094362079
                0.00138856546525568
                0.00150154812112431
                0.00191035559350393
                0.00237522316230692
                0.0023812604034602
                0.00220876779908061
                0.00185343303405866
                0.00124798399268631
                0.00104961749764979
                0.00144893787678853
                0.00179219815950391
                0.00215788248078864
                0.00206818632651125
                0.00173441313703675
                0.000928010211562179
                0.000962508732438097
                0.00140667718871553
                0.00173786298912434
                0.0018370462366426
                0.00183273392153311
                0.00167921550363528
                0.00104185533045271
                0.000926285285518383
                0.00154122142013161
                0.00166455363226302
                0.0017982354006572
                0.00195089135553313
                0.00168956505989806
                0.00101425651375197
                0.00113413887379579
                0.00172578850681777
                0.00201643854519737
                0.00209319775414629
                0.00207336110464264
                0.00122900980620456
                0.00110567759407315
                0.00115138813423374
                0.00169560230105134
                0.00193536702113897
                0.00201557608217548
                0.0020069514519565
                0.00218375637144557
                0.00137390359388341
                0.00152224723364986
                0.00195347874459883
                0.00253909113646752
                0.0025071800046573
                0.00276074413309529
                0.00272710807524127
                0.00180427264181048
                0.00180082278972289
                0.00248993074421934
                0.00276333152216099
                0.00349038784962095
                0.00353437346373774
                0.00337136795259903
                0.00226137804341639
                0.00262447497563542
                0.00341535356671583
                0.00418725797131448
                0.00460296514786929
                0.00504713360414672
                0.00462970150154812
                0.00295307338697853
                0.00413119787489111
                0.00503074680673066
                0.00558272314074534
                0.00617954755189871
                0.00669012566086229
                0.00495398759778175
                0.00611141297316878
                0.00734904740959231
                0.00901273857883343
                0.00925595315100865
                0.00945604457208897
                0.00854614608398665
                0.00843747574322751
                0.00685744348711049
                0.00837106609054137
                0.0103141952788774
                0.0115242308986002
                0.0102624474975635
                0.0115043942490966
                0.0099890467196219
                0.00979068022458537
                0.0117105229113302
                0.0144152069480021
                0.0159081304389074
                0.0144143444849802
                0.0119080269433448
                0.00900066409652686
                0.00761123616824929
                0.00812267674023476
                0.00847456165316912
                0.00897996498400131
                0.00825463358258515
                0.00499366089678905
                0.00378017542497865
                0.00297808481461357
                0.00326356007486179
                0.00360250804246768
                0.00284699043528509
                0.00269433448040915
                0.0020880229760149
                0.00155933314359147
                0.00123245965829215
                0.00132474320163523
                0.00127299542032135
                0.00138597807618998
                0.0012531587708177
                0.00111257729824834
                0.000870225189095018
                0.000800365684321285
                0.000765004700423469
                0.00102115621792716
                0.000908173562058527
                0.000889199375576772
                0.000827102038000121
                0.00067272115708039
                0.000592512096043882
                0.000679620861255574
                0.00083141435310961
                0.000736543420700837
                0.000799503221299387
                0.000645122340379656
                0.00050971564594168
                0.000528689832423435
                0.000540764314730006
                0.000639085099226371
                0.000627873079941698
                0.000683933176365063
                0.000613211208569433
                0.000441581067211743
                0.000414844713532907
                0.000476079588087661
                0.000574400372584025
                0.000570088057474536
                0.000515752887094966
                0.000553701260058475
                0.000391558211941663
                0.00038034619265699
                0.000413982250511009
                0.000548526481927087
                0.000438131215124152
                0.000485566681328538
                0.000377758803591296
                0.00032601102227742
                0.000285475260248217
                0.000363959395240929
                0.000293237427445298
                0.000307036835795665
                0.000361372006175235
                0.000352747375956256
                0.000276850630029237
                0.000232002552890545
                0.000281162945138727
                0.000319111318102236
                0.00032169870716793
                0.000424331806773785
                0.000356197228043848
                0.000262188758656973
                0.000282887871182523
                0.00032169870716793
                0.000382071118700786
                0.000419157028642397
                0.000427781658861376
                0.000359647080131439
                0.000263913684700768
                0.000336360578540195
                0.000395008064029255
                0.000461417716715396
                0.00056405081632125
                0.000494191311547517
                0.000506265793854088
                0.000410532398423418
                0.000369996636394215
                0.000440718604189845
                0.000500228552700803
                0.000607173967416147
                0.000576125298627821
                0.000558013575167965
                0.000426919195839478
                0.000401907768204438
                0.000528689832423435
                0.000563188353299352
                0.000551976334014679
                0.0006270106169198
                0.000583887465824903
                0.000399320379138744
                0.000495053774569415
                0.000526102443357741
                0.000616661060657024
                0.000708082140978206
                0.000685658102408859
                0.000745168050919817
                0.000511440571985476
                0.000497641163635109
                0.000517477813138762
                0.000676171009167982
                0.000739130809766531
                0.00073136864256945
                0.000688245491474553
                0.000477804514131457
                0.000486429144350436
                0.000501091015722701
                0.000699457510759226
                0.000814165092671652
                0.000696007658671634
                0.000746030513941715
                0.000565775742365046
                0.000452793086496416
                0.000598549337197168
                0.000638222636204473
                0.000720156623284777
                0.000673583620102288
                0.000584749928846801
                0.000569225594452638
                0.000419157028642397
                0.000551113870992781
                0.00062269830181031
                0.000594237022087678
                0.000560600964233658
                0.000457967864627804
                0.000418294565620499
                0.000300137131620482
                0.000453655549518314
                0.000440718604189845
                0.000498503626657007
                0.000439856141167947
                0.000442443530233641
                0.000279438019094931
                0.000276850630029237
                0.000280300482116829
                0.000364821858262827
                0.00032601102227742
                0.000293237427445298
                0.00018370462366426
                0.000119882360043813
                0.000141443935591262
                0.000144893787678853
                0.00018801693877375
                0.000222515459649668
                0.000194916642948934
                0.00018801693877375
                0.000136269157459874
                0.000111257729824834
                0.000102633099605854
                0.000148343639766445
                0.000146618713722649
                0.000165592900204404
                0.000159555659051118
                0.000116432507956221
                0.000109532803781038
                0.000112120192846732
                0.000152655954875935
                0.000151793491854037
                0.000137131620481772
                0.000123332212131405
                0.000131956842350384
                0.000125919601197099
                9.83207844963647e-05
                0.000143168861635057
                0.000154380880919731
                0.000157830733007322
                0.000181117234598567
                0.0001673178262482
                0.000210440977343096
                0.000146618713722649
                0.00018370462366426
                0.000180254771576669
                0.000172492604379587
                0.000244939498219014
                0.00015869319602922
                0.000257876443547483
                0.000181117234598567
                0.000247526887284708
                0.000298412205576686
                0.000220790533605872
                0.000255289054481789
                0.000219928070583974
                0.000255289054481789
                0.000232865015912443
                0.000274263240963544
                0.000306174372773767
                0.000297549742554788
                0.000319111318102236
                0.000331185800408807
                0.000255289054481789
                0.000385520970788377
                0.000457105401605906
                0.000432956436992764
                0.000495053774569415
                0.000508853182919782
                0.000354472302000052
                0.000404495157270132
                0.000452793086496416
                0.000571812983518332
                0.000641672488292064
                0.000788291202014714
                0.000750342829051204
                0.000632185395051187
                0.000602861652306657
                0.000790016128058509
                0.000890924301620568
                0.000911623414146119
                0.00109791542687607
                0.000978895529854158
                0.00094439700897824
                0.000896099079751956
                0.00124712152966442
                0.00145842497002941
                0.0015472586612849
                0.0016300551113871
                0.00206991125255505
                0.00136959127877392
                0.00139374024338706
                0.00187154475751852
                0.00189655618515356
                0.00222860444858427
                0.00203713765772293
                0.00237953547741641
                0.00200091421080321
                0.00178788584439442
                0.00234244956747479
                0.00277368107842376
                0.00247009409471569
                0.00273055792732887
                0.00295307338697853
                0.00253650374740183
                0.00240713429411714
                0.00296342294324131
                0.0032187119977231
                0.00290563792077415
                0.00335239376611728
                0.00333859435776691
                0.00300137131620482
                0.00281594176649676
                0.00302724520686176
                0.00340414154743115
                0.00353092361165015
                0.0038853959136502
                0.0031755888466282
                0.00363269424823411
                0.00299188422296394
                0.00383537305838012
                0.00366546784306623
                0.0037620637015188
                0.00415017206137287
                0.00408462487170863
                0.00358439631900782
                0.00316523929036543
                0.00379569975937282
                0.0038431352255772
                0.00328857150249683
                0.00364563119356258
                0.0028418156571537
                0.00277281861540186
                0.00264344916211717
                0.00253391635833614
                0.00262275004959162
                0.00259515123289089
                0.00266414827464272
                0.00220531794699302
                0.00201212623008788
                0.00201471361915358
                0.00180599756785428
                0.00211130947760615
                0.00211562179271564
                0.00187068229449662
                0.00205266199211709
                0.00135492940740166
                0.00133336783185421
                0.00146532467420459
                0.0015446712722192
                0.00157744486705133
                0.0015049979732119
                0.00133940507300749
                0.00130059423702209
                0.000926285285518383
                0.00109360311176658
                0.00150672289925569
                0.00126609571614617
                0.00118243680302207
                0.000941809619912546
                0.00113500133681768
                0.00102201868094905
                0.00140667718871553
                0.00112033946544542
                0.000853838391678957
                0.00107807877737242
                0.000857288243766549
                0.000826239574978223
                0.000833139279153406
                0.000882299671401589
                0.000915935729255608
                0.00102201868094905
                0.0010849784815476
                0.000981482918919851
                0.000909036025080425
                0.000840901446350488
                0.000912485877168016
                0.000937497304803057
                0.00105910459089067
                0.000991832475182627
                0.000895236616730058
                0.000730506179547552
                0.000779666571795734
                0.00083141435310961
                0.000846076224481875
                0.00112120192846732
                0.000928010211562179
                0.00081502755569355
                0.000924560359474588
                0.000881437208379691
                0.00109101572270089
                0.00128420743960603
                0.00119709867439434
                0.00144031324656955
                0.00134802970322647
                0.00101080666166438
                0.000642534951313962
                0.00169818969011704
                0.00159383166446739
                0.00177926121417544
                0.00158434457122651
                0.00180513510483238
                0.00144031324656955
                0.00150068565810241
                0.00168870259687616
                0.00208457312392731
                0.00203455026865723
                0.00229587656429231
                0.00227000267363537
                0.00228983932313902
                0.00164989176089075
                0.00222342967045288
                0.00295134846093474
                0.00263568699492009
                0.00258566413965001
                0.00286855201083254
                0.00255375300783979
                0.00250373015256971
                0.00287890156709531
                0.00340241662138736
                0.00296946018439459
                0.00327649702019026
                0.00303500737405884
                0.0030108584094457
                0.00289183851242378
                0.00282025408160625
                0.00255634039690548
                0.00290046314264276
                0.00213545844221929
                0.00287027693687633
                0.00252097941300767
                0.00220186809490543
                0.0016723157994601
                0.00172923835890536
                0.00184739579290538
                0.00186205766427764
                0.00211044701458425
                0.00207681095673023
                0.00189914357421926
                0.00183100899548932
                0.00199746435871562
                0.00203282534261344
                0.00197504032014627
                0.00209751006925578
                0.00184480840383969
                0.0019621033748178
                0.001673178262482
                0.00144635048772284
                0.00161539324001483
                0.00159383166446739
                0.00171026417242361
                0.0016300551113871
                0.00144548802470094
                0.00166024131715353
                0.00165937885413163
                0.00160331875770826
                0.00153518417897833
                0.00157313255194184
                0.00148602378673014
                0.00147222437837978
                0.0015058604362338
                0.00147308684140167
                0.00157140762589804
                0.00159986890562067
                0.00127472034636515
                0.00118416172906587
                0.000870225189095018
                0.00137045374179582
                0.00132301827559143
                0.00136959127877392
                0.00122297256505127
                0.0010435802564965
                0.00122211010202938
                0.00107721631435052
                0.00128248251356223
                0.00107635385132862
                0.00136355403762064
                0.00120399837856952
                0.00135837925948925
                0.00122987226922646
                0.00119709867439434
                0.00107117907319724
                0.00114535089308046
                0.000976308140788464
                0.00086505041096363
                0.00086073809585414
                0.000851251002613263
                0.000905586172992833
                0.000817614944759243
                0.000842626372394284
                0.000875399967226405
                0.000772766867620551
                0.000805540462452672
                0.000719294160262879
                0.000713256919109593
                0.000733956031635144
                0.000898686468817649
                0.000843488835416182
                0.000712394456087695
                0.000725331401416164
                0.00068134578729937
                0.000708082140978206
                0.000607173967416147
                0.000567500668408842
                0.000694282732627839
                0.000614073671591331
                0.000675308546146084
                0.000621835838788412
                0.00133940507300749
                0
                0.000559738501211761
                0.00069773258471543
                0.000809852777562162
                0.000687383028452655
                0.000502815941766497
                0.000472629736000069
                0.000530414758467231
                0.000488154070394232
                0.000563188353299352
                0.000631322932029289
                0.00046400510578109
                0.00053903938868621
                0.000477804514131457
                0.000603724115328555
                0.000423469343751887
                0.000375171414525602
                0.000352747375956256
                0.000352747375956256
                0.000288925112335809
                0.000412257324467213
                0.000366546784306623
                0.000314799002992747
                0.00035102244991246
                0.000345847671781072
                0.000252701665416095
                0.00027167585189785
                0.000216478218496382
                0.000269950925854054
                0.000175942456467179
                0.000200091421080321
                0.00018370462366426
                0.000146618713722649
                0.000128506990262792
                0.000323423633211726
                0
                0.000136269157459874
                0.000145756250700751
                0.000127644527240895
                0.000113845118890528
                0.000114707581912426
                9.65958584525688e-05
                9.83207844963647e-05
                9.65958584525688e-05
                0.000127644527240895
                0.000105220488671548
                0.000101770636583956
                7.58967459270184e-05
                8.62463021897936e-05
                9.05586172992833e-05
                9.91832475182627e-05
                9.31460063649771e-05
                0.00011298265586863
                6.55471896642431e-05
                8.79712282335895e-05
                0.000107807877737242
                8.53838391678957e-05
                6.98595047737328e-05
                9.14210803211812e-05
                7.93465980146101e-05
                6.7272115708039e-05
                8.19339870803039e-05
                2.84612797226319e-05
                9.91832475182627e-05
                6.81345787299369e-05
                6.03724115328555e-05
                7.58967459270184e-05
                8.19339870803039e-05
                7.41718198832225e-05
                0.000154380880919731
                0
                0.000100045710540161
                0.000106945414715344
                0.000115570044934323
                7.67592089489163e-05
                6.55471896642431e-05
                9.57333954306709e-05
                0.000102633099605854
                0.000118157434000017
                0.000119019897021915
                0.000168180289270098
                8.88336912554874e-05
                0.000142306398613159
                0.000175079993445281
                0.000116432507956221
                0.000141443935591262
                0.000143168861635057
                9.57333954306709e-05
                9.57333954306709e-05
                8.79712282335895e-05
                9.57333954306709e-05
                0.000100045710540161
                0.000111257729824834
                0.000112120192846732
                0.000100045710540161
                0.000146618713722649
                0.000101770636583956
                9.65958584525688e-05
                0.000132819305372282
                0.000119019897021915
                0.00010435802564965
                0.000142306398613159
                0.000260463832613177
                0
                0.000135406694437976
                0.00022165299662777
                0.000153518417897833
                0.00013799408350367
                9.57333954306709e-05
                0.00016300551113871
                0.000140581472569364
                0.000186292012729954
                0.000138856546525568
                0.000150931028832139
                0.000177667382510975
                0.000153518417897833
                0.000149206102788343
                0.000163867974160608
                0.00015869319602922
                0.000156105806963526
                0.000169905215313893
                0.000229415163824851
                0.000156968269985424
                0.000175079993445281
                0.000216478218496382
                0.000198366495036525
                0.000209578514321198
                0.000357922154087644
                0.000392420674963561
                0.00029668727953289
                0.000307036835795665
                0.000291512501401502
                0.000384658507766479
                0.000348435060846766
                0.000281162945138727
                0.000278575556073033
                0.00029668727953289
                0.00033032333738691
                0.000251839202394197
                0.000247526887284708
                0.000348435060846766
                0.000396732990073051
                0.00035533476502195
                0.00038034619265699
                0.000356197228043848
                0.000336360578540195
                0.000368271710350419
                0.000262188758656973
                0.000293237427445298
                0.000337223041562093
                0.000294099890467196
                0.000297549742554788
                0.000283750334204421
                0.000311349150905155
                0.000265638610744564
                0.000253564128437993
                0.000298412205576686
                0.000411394861445316
                0.000344122745737276
                0.00035533476502195
                0.000333773189474501
                0.000319111318102236
                0.000374308951503704
                0.000440718604189845
                0.000363096932219031
                0.000395870527051153
                0.000299274668598584
                0.000452793086496416
                0.000365684321284725
                0.000376896340569398
                0.000410532398423418
                0.000551976334014679
                0.000546801555883292
                0.000439856141167947
                0.000475217125065763
                0.000522652591270149
                0.000489878996438028
                0.000418294565620499
                0.000486429144350436
                0.000443305993255539
                0.00042605673281758
                0.000416569639576703
                0.000363096932219031
                0.000345847671781072
                0.000354472302000052
                0.000412257324467213
                0.000416569639576703
                0.000474354662043865
                0.000326873485299318
                0.000266501073766462
                0.000351884912934358
                0.000323423633211726
                0.000398457916116847
                0.000345847671781072
                0.000367409247328521
                0.000224240385693463
                0.000302724520686176
                0.000312211613927053
                0
                0.000116432507956221
                0.000146618713722649
                8.62463021897936e-05
                7.33093568613246e-05
                6.7272115708039e-05
                4.13982250511009e-05
                5.69225594452638e-05
                4.57105401605906e-05
                5.95099485109576e-05
                1.03495562627752e-05
                2.7598816700734e-05
                3.62234469197133e-05
                2.06991125255505e-05
                0
                1.72492604379587e-05
                1.46618713722649e-05
                6.89970417518349e-06
                0
                2.58738906569381e-06
                2.58738906569381e-06
                0
                5.17477813138762e-06
                1.72492604379587e-06
                0
                4.31231510948968e-06
                0
                6.03724115328555e-06
                1.72492604379587e-06
                0
                8.62463021897936e-07
                8.62463021897936e-07
                0
                8.62463021897936e-07
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                0
                2.58738906569381e-06
        ]
    end

    return v
end


function _get_prob_test(x::Human,test::Int64)
    M = get_matrix(x,test)
    pp = [0.001 0.002 0.002 0.002]
    #1 - RT-PCR, 2 - Abbott_PanBio 3 - BTNX_Rapid_Response	4 - Artron
    if x.daysinf+1 > size(M,2)
        d = 1
        #[0.005 0.015 0.015 0.015]
        prob = pp[1,test]
        
    else
        #Let's create a Tuple with one matrix for each strain
        d = x.daysinf+1 #first row is 0
        prob = M[x.incubationp,d]

        prob = prob*(p.asymp_red^(x.wentto-1))

        prob = max(prob,pp[1,test])

    end

    
    return prob
end

